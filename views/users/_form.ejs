<%if (!user.id) {%>
<h1 class="loginWelcomeMessage">
    Reg√≠strate:
</h1>
    <form method="post" action="/users">
<%}else{%>
    <form method="post" action="/users/<%=user.id%>?_method=PUT%>">
<%}%>

<div>
         <label for="name"><span><%=i18n.user.name%></span>
         <input type="text" class="customInput" id="name" name="name" value="<%= user.name %>" required placeholder="<%=i18n.user.inputs.namePlaceHolder %>" autocomplete="off"/> </label>
</div>
<br />
<div>
         <label for="surname"><span><%=i18n.user.surname%></span>
        <input type="text" class="customInput" id="surname" name="surname" value="<%= user.surname %>" required placeholder="<%=i18n.user.inputs.surnamePlaceHolder %>" autocomplete="off"/></label>
</div>
<br />
<div>
        <label for="gender"><span><%=i18n.user.gender%></span>
        <select  required class="customInput" id="gender" name="gender" value="<%= user.gender %>" placeholder="<%=i18n.user.inputs.genderPlaceHolder %>" autocomplete="off">
            <option value="" disabled <%= !user.id ? "selected" : ""%>> <option>
            <option value="Femenino" <%= user.gender === "Femenino" ? "selected" : ""%>>Mujer</option>
            <option value="Masculino" <%= user.gender === "Masculino" ? "selected" : ""%>>Hombre</option>
            <option value="Otro" <%= user.gender === "Otro" ? "selected" : ""%>>Otro</option>
        </select></label>
</div>
<br />
<div>
        <label for="username"><span><%=i18n.user.username%></span>
        <input type="email" <%=user.id?"disabled":""%> class="customInput" id="username" name="username" value="<%= user.username %>" required placeholder="<%=i18n.user.inputs.usernamePlaceHolder %>" autocomplete="off"/></label>
</div>
<br />
<div>
    <label for="dni"><span><%=i18n.user.dni%></span>
        <input type="dni" <%=user.id?"disabled":""%> class="customInput" id="dni" name="dni" value="<%= user.dni %>" required placeholder="<%=i18n.user.inputs.dniPlaceHolder %>" autocomplete="off"/></label>
</div>
<br />
<div>
        <label for="user_password"><span><%=i18n.user.password%></span>
        <input type="password" class="customInput" id="user_password" name="password" required placeholder="<%=i18n.user.inputs.passwordPlaceHolder %>" autocomplete="off"/></label>
</div>
<br />
<div>
        <label for="user_confirm_password"><span><%=i18n.user.passwordConfirm%></span>
        <input type="password" class="customInput" id="user_confirm_password" required placeholder="<%=i18n.user.inputs.passwordConfirmPlaceHolder %>" autocomplete="off"/></label>
</div>
<br />
<%if (!user.id) {%>
    <button class="registro" type="submit" value="Save" onclick="return (confirmPassword() && confirmDNI())"><%=i18n.user.actions.register %></button>
    <br />
    <br />
    <a class="login" href="/"><%=i18n.user.actions.alreadyRegistered %></a>
<%} else {%>
    <button class="save" type="submit" value="edit" onclick="return confirmPassword()"><%=i18n.user.actions.save %></button>

<%} %>


<script>
    function confirmPassword() {
        var pw1 = document.getElementById('user_password').value;
        var pw2 = document.getElementById('user_confirm_password').value;
        if (!pw1 || !pw2) {
            alert('<%=i18n.user.messages.fillIn %>.');
            return false;
        }
        if (pw1 === pw2) {
            return true;
        } else {
            alert('<%=i18n.user.messages.doNotMatch %>.');
            return false;
        }
    }

    function confirmDNI(){
        var numero, letr, letra, expresion_regular_dni;
        var dni = document.getElementById('dni').value;
        expresion_regular_dni = /^\d{8}[a-zA-Z]$/;

        if(expresion_regular_dni.test (dni) == true){
            numero = dni.substr(0,dni.length-1);
            letr = dni.substr(dni.length-1,1);
            numero = numero % 23;
            letra='TRWAGMYFPDXBNJZSQVHLCKET';
            letra=letra.substring(numero,numero+1);
            if (letra!=letr.toUpperCase()) {
                alert('<%=i18n.user.messages.wrongLetterDNI %>');
                return false;
            }else{
                return true;
            }
        }else{
            alert('<%=i18n.user.messages.invalidDNI %>');
            return false;
        }
    }
</script>

    </form>
    </form>
